(self.webpackChunkomniscraper_frontend=self.webpackChunkomniscraper_frontend||[]).push([[179],{6755:(e,t,n)=>{"use strict";n.d(t,{b:()=>c});var o=n(9669);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=n.n(o)().create({baseURL:"https://omniscraper.herokuapp.com/api/",timeout:5e3,headers:{Authorization:localStorage.getItem("access_token")?"JWT ".concat(localStorage.getItem("access_token")):null,"Content-Type":"application/json",accept:"application/json"}});c.interceptors.response.use((function(e){return e}),(function(e){var t=e.config;if(localStorage.getItem("refresh_token")&&401===e.response.status&&"Unauthorized"===e.response.statusText){var n=localStorage.getItem("refresh_token");return c.post("/token/refresh/",{refresh:n}).then((function(e){return localStorage.setItem("access_token",e.data.access),localStorage.setItem("refresh_token",e.data.refresh),c.defaults.headers.Authorization="JWT "+e.data.access,t.headers.Authorization="JWT "+e.data.access,c(t)})).catch((function(e){return console.log(e)}))}return Promise.reject(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))}))},9497:(e,t,n)=>{"use strict";var o=n(7294),r=n(3935),a=n(5513),c=n(2487),i=n(9669),l=n.n(i),s=n(5258),u=n(8358),f=n(282),d=n(773);function g(e){return(g="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function y(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=v(e);if(t){var r=v(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return b(this,n)}}function b(e,t){return!t||"object"!==g(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var k=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(i,e);var t,n,r,c=y(i);function i(){return p(this,i),c.apply(this,arguments)}return t=i,(n=[{key:"render",value:function(){var e=this.props,t=e.loggedIn,n=e.handleLogout,r=e.classes,c=e.handleClearClickedTag;return o.createElement("div",{style:{flexGrow:1,margin:0}},o.createElement(s.Z,{position:"fixed",style:{backgroundColor:"#1a1c20"}},o.createElement(u.Z,null,o.createElement("h3",{style:{flexGrow:1,textTransform:"uppercase",letterSpacing:"0.1em"},onClick:c},o.createElement(a.rU,{to:"/",style:{color:"white",textDecoration:"none",cursor:"pointer"}},"Omniscraper")),o.createElement("div",null,t&&o.createElement(o.Fragment,null,o.createElement(f.Z,{size:"small",variant:"contained",component:a.rU,to:"/",className:r.navLink,onClick:n},"Logout"))))))}}])&&h(t.prototype,n),r&&h(t,r),i}(o.Component);const S=(0,d.Z)((function(e){return{navLink:{textDecoration:"none",cursor:"pointer"}}}))(k);var O=n(6755),w=n(7373),E=n(3457),T=n(8905);function _(e){return(_="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function j(e){return function(e){if(Array.isArray(e))return I(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"===typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return I(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function C(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function L(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function A(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=W(e);if(t){var r=W(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return R(this,n)}}function R(e,t){return!t||"object"!==_(t)&&"function"!==typeof t?x(e):t}function x(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e){return(W=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var D=o.lazy((function(){return Promise.all([n.e(216),n.e(830)]).then(n.bind(n,4830))})),M=o.lazy((function(){return Promise.all([n.e(216),n.e(351)]).then(n.bind(n,351))})),U=o.lazy((function(){return Promise.all([n.e(216),n.e(219)]).then(n.bind(n,1219))})),V=o.lazy((function(){return Promise.all([n.e(216),n.e(624)]).then(n.bind(n,7624))})),Z=(0,w.Z)({typography:{fontFamily:["Montserrat"].join(",")},palette:{primary:{main:"#185adb"},secondary:{main:"#cf0000"}}});const B=function(e){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(s,e);var t,n,r,i=A(s);function s(){var e;C(this,s);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];return z(x(e=i.call.apply(i,[this].concat(n))),"state",{username:"",password:"",loggedIn:!!localStorage.getItem("access_token"),loginLoading:!1,error:null,clickedTag:parseInt(localStorage.getItem("clicked_tag"))||null,tagsLoading:!1,videoTags:[],videosLoadingError:!1,loading:!1,offset:0,limit:8,videos:[],hasMore:!0}),z(x(e),"onRouteChange",(function(){window.gtag("config","UA-190601275-1",{page_title:e.props.location.pathname,page_path:e.props.location.pathname})})),z(x(e),"loadVideos",(function(){e.setState({loading:!0},(function(){var t=e.state,n=t.offset,o=t.limit,r="https://omniscraper.herokuapp.com/api/videos/?limit=".concat(o,"&offset=").concat(n);l().get(r).then((function(t){var r=t.data.videos,a=t.data.has_more;e.setState({hasMore:a,loading:!1,videos:[].concat(j(e.state.videos),j(r)),offset:n+o})})).catch((function(t){e.setState({videosLoadingError:t.message,loading:!1})}))}))})),z(x(e),"loadTags",(function(){e.setState({tagsLoading:!0},(function(){l().get("https://omniscraper.herokuapp.com/api/tags/").then((function(t){var n=t.data.tags;e.setState({videoTags:n,tagsLoading:!1})})).catch((function(t){e.setState({tagsLoading:!1})}))}))})),z(x(e),"handleClickedTag",(function(t){e.setState({clickedTag:t},(function(){return localStorage.setItem("clicked_tag",e.state.clickedTag)}))})),z(x(e),"handleClearClickedTag",(function(){localStorage.removeItem("clicked_tag"),e.setState({clickedTag:null})})),z(x(e),"handleChange",(function(t){e.setState(z({},t.target.name,t.target.value))})),z(x(e),"handleLogin",(function(t){var n=e.state,o=n.username,r=n.password;t.preventDefault(),e.setState({loginLoading:!0},(function(){O.b.post("token/obtain/",{username:o,password:r}).then((function(t){O.b.defaults.headers.Authorization="JWT "+t.data.access,localStorage.setItem("access_token",t.data.access),localStorage.setItem("refresh_token",t.data.refresh),e.setState({loggedIn:!0,loginLoading:!1,username:"",password:""})})).catch((function(t){e.setState({loggedIn:!1,loginLoading:!1})}))}))})),z(x(e),"handleLogout",(function(){O.b.post("/blacklist/",{refresh_token:localStorage.getItem("refresh_token")}).then((function(t){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),O.b.defaults.headers.Authorization=null,e.setState({loggedIn:!1})})).catch((function(t){console.log(t.statusText),e.setState({loggedIn:!1})}))})),e}return t=s,(n=[{key:"componentDidMount",value:function(){this.loadTags(),this.loadVideos()}},{key:"componentDidUpdate",value:function(e){this.props.location!==e.location&&this.onRouteChange()}},{key:"render",value:function(){var e=this.handleChange,t=this.handleLogin,n=this.handleLogout,r=this.handleClickedTag,i=this.handleClearClickedTag,l=this.loadTags,s=this.loadVideos,u=this.state,f=u.username,d=u.password,g=u.error,p=u.loggedIn,h=u.loginLoading,m=u.videoTags,y=u.clickedTag,b=u.tagsLoading,v=u.videosLoadingError,k=u.loading,O=u.hasMore,w=u.videos;return o.createElement(E.Z,{theme:Z},o.createElement(a.VK,null,o.createElement("div",null,o.createElement(o.Suspense,{fallback:o.createElement("div",{style:{height:"100vh",display:"grid",placeItems:"center"}},o.createElement(T.g,{color:"#185adb",height:50,width:50}))},o.createElement(S,{loggedIn:p,handleLogout:n,handleClearClickedTag:i}),o.createElement(c.rs,null,p?o.createElement(c.l_,{from:"/login",to:"/"}):"",o.createElement(c.AW,{exact:!0,path:"/"},o.createElement(D,{loggedIn:p,videoTags:m,handleClickedTag:r,clickedTag:y,tagsLoading:b,loadTags:l,error:v,loading:k,hasMore:O,videos:w,loadVideos:s})),o.createElement(c.AW,{path:"/tags/:slug",children:o.createElement(V,{videoTags:m,loggedIn:p,handleClickedTag:r,clickedTag:y,tagsLoading:b,loadTags:l})}),o.createElement(c.AW,{path:"/login",children:o.createElement(M,{username:f,password:d,loginLoading:h,error:g,handleChange:e,handleSubmit:t})}),o.createElement(c.AW,{path:"/:slug",children:o.createElement(U,null)}))))))}}])&&L(t.prototype,n),r&&L(t,r),s}(o.Component);r.render(o.createElement(a.VK,null,o.createElement(B,null)),document.getElementById("app")),"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("./service-worker.js").then((function(e){console.log("SW registered: ",e)})).catch((function(e){console.log("SW ERROR: ",e)}))}))}},e=>{"use strict";e.O(0,[216],(()=>{return t=9497,e(e.s=t);var t}));e.O()}]);